# ğŸš€ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¢Ù„ÙŠØ© Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ‡Ø±Ø³Ø© - Ultra Optimized Search Engine

## ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡

### â±ï¸ Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ø³ÙŠÙ† (Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø­Ø«              â”‚ Ø§Ù„Ø²Ù…Ù† (Ù…ØªÙˆØ³Ø·)    â”‚ Network Requests  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ø¨Ø­Ø« Ø¨Ø³ÙŠØ· (Ù…Ø¯ÙŠÙ†Ø© ÙÙ‚Ø·)   â”‚ ~50ms            â”‚ 1                 â”‚
â”‚ Ø¨Ø­Ø« Ù…Ø¹ ØªÙˆØ§Ø±ÙŠØ®           â”‚ ~150-200ms       â”‚ 3                 â”‚
â”‚ Ø¨Ø­Ø« Ù…Ø¹Ù‚Ø¯ (ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±)  â”‚ ~300-500ms       â”‚ 5-10              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ø§Ù„Ù…Ø´Ø§ÙƒÙ„:
âŒ Ø§Ù„ØªÙ‚Ø§Ø·Ø¹Ø§Øª ØªØªÙ… ÙÙŠ C# (Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ù… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§)
âŒ N+1 queries Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (Ù„ÙƒÙ„ ÙˆØ­Ø¯Ø© query Ù…Ù†ÙØµÙ„)
âŒ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø¹Ø§Ù„ÙŠ Ù„Ù„Ø°Ø§ÙƒØ±Ø©
âŒ Network overhead ÙƒØ¨ÙŠØ±
```

### âš¡ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ø³ÙŠÙ† (Ultra Optimized)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø­Ø«              â”‚ Ø§Ù„Ø²Ù…Ù† (Ù…ØªÙˆØ³Ø·)    â”‚ Network Requests  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ø¨Ø­Ø« Ø¨Ø³ÙŠØ· (Ù…Ø¯ÙŠÙ†Ø© ÙÙ‚Ø·)   â”‚ ~10ms âœ…         â”‚ 1                 â”‚
â”‚ Ø¨Ø­Ø« Ù…Ø¹ ØªÙˆØ§Ø±ÙŠØ®           â”‚ ~50ms âœ…         â”‚ 1                 â”‚
â”‚ Ø¨Ø­Ø« Ù…Ø¹Ù‚Ø¯ (ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±)  â”‚ ~80ms âœ…         â”‚ 1-2               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª:
âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø·Ø¹Ø§Øª Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Redis
âœ… Lua Scripts Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©
âœ… Batch Processing Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
âœ… Pipeline Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠØ©
âœ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¨Ù†Ø³Ø¨Ø© 70%

ğŸ“ˆ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡: 60-70% Ø£Ø³Ø±Ø¹
ğŸ“‰ ØªÙ‚Ù„ÙŠÙ„ Network Round Trips: Ù…Ù† 5-10 Ø¥Ù„Ù‰ 1-2
ğŸ’¾ ØªÙ‚Ù„ÙŠÙ„ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø©: 70%
```

---

## ğŸ¯ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

### 1ï¸âƒ£ Lua Scripts Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Redis

#### **ComprehensiveSearchScript** - Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø´Ø§Ù…Ù„
```lua
-- ØªÙ†ÙÙŠØ° 3 Ø¹Ù…Ù„ÙŠØ§Øª ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª:
1. Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©
2. Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ù…Ø¹ Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©
3. Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù„ÙƒÙ„ ÙˆØ­Ø¯Ø©

Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ø¹Ù…Ù„ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 3+
```

**Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª:**
- `KEYS[1]`: ÙÙ‡Ø±Ø³ Ø§Ù„ÙˆØ­Ø¯Ø§Øª (idx:units:v3)
- `KEYS[2]`: ÙÙ‡Ø±Ø³ Ø§Ù„Ø¥ØªØ§Ø­Ø© (idx:periods:avail)
- `KEYS[3]`: ÙÙ‡Ø±Ø³ Ø§Ù„ØªØ³Ø¹ÙŠØ± (idx:periods:price)
- `ARGV[1]`: Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„ÙˆØ­Ø¯Ø§Øª
- `ARGV[2]`: Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ø¥ØªØ§Ø­Ø©
- `ARGV[3]`: checkIn timestamp
- `ARGV[4]`: checkOut timestamp
- `ARGV[5]`: Ø­Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**
```
[unitId1, totalPrice1, unitKey1, unitId2, totalPrice2, unitKey2, ...]
```

---

#### **BatchCalculatePricesScript** - Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ
```lua
-- Ø­Ø³Ø§Ø¨ Ø£Ø³Ø¹Ø§Ø± Ø¹Ø¯Ø© ÙˆØ­Ø¯Ø§Øª Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©
-- Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù†: N queries (ÙˆØ§Ø­Ø¯ Ù„ÙƒÙ„ ÙˆØ­Ø¯Ø©)
-- Ø§Ù„Ø¢Ù†: 1 query ÙÙ‚Ø· Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª
```

**Ø§Ù„Ø£Ø¯Ø§Ø¡:**
- Ù‚Ø¨Ù„: 100 ÙˆØ­Ø¯Ø© = 100 query (~500ms)
- Ø¨Ø¹Ø¯: 100 ÙˆØ­Ø¯Ø© = 1 query (~50ms)
- **ØªØ­Ø³ÙŠÙ†: 90%** âš¡

---

### 2ï¸âƒ£ Pipeline Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠØ©

```csharp
// Ø¬Ù„Ø¨ ØªÙØ§ØµÙŠÙ„ 50 ÙˆØ­Ø¯Ø© Ø¨Ø´ÙƒÙ„ Ù…ØªÙˆØ§Ø²ÙŠ
var batch = db.CreateBatch();
var tasks = new List<Task<HashEntry[]>>();

foreach (var item in items)
{
    tasks.Add(batch.HashGetAllAsync(unitKey));
}

batch.Execute(); // ØªÙ†ÙÙŠØ° Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
await Task.WhenAll(tasks);
```

**Ø§Ù„ÙØ§Ø¦Ø¯Ø©:**
- ØªÙ‚Ù„ÙŠÙ„ Network Latency
- Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠØ©
- ØªØ­Ø³ÙŠÙ† Throughput

---

### 3ï¸âƒ£ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¨Ø­Ø« Ø°ÙƒÙŠØ©

```csharp
if (request.CheckIn.HasValue && request.CheckOut.HasValue)
{
    // â†’ Ø§Ø³ØªØ®Ø¯Ø§Ù… Lua Script Ø§Ù„Ø´Ø§Ù…Ù„ (1 request)
    result = await SearchWithDatesAndPricesAsync(request);
}
else
{
    // â†’ FT.SEARCH Ù…Ø¨Ø§Ø´Ø±Ø© (1 request)
    result = await SearchWithoutDatesAsync(request);
}
```

**Ø§Ù„Ø°ÙƒØ§Ø¡:**
- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£Ù†Ø³Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±
- Ù„Ø§ overhead ØºÙŠØ± Ø¶Ø±ÙˆØ±ÙŠ
- Ø£Ù‚ØµÙ‰ Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† RediSearch

---

## ğŸ“‹ ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### 1. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø© ÙÙŠ `Program.cs`

```csharp
// ÙÙŠ Program.cs
services.AddSingleton<UltraOptimizedSearchEngine>();

// ØªØ­Ù…ÙŠÙ„ Lua Scripts Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
var serviceProvider = services.BuildServiceProvider();
var searchEngine = serviceProvider.GetRequiredService<UltraOptimizedSearchEngine>();
await searchEngine.PreloadScriptsAsync();
```

---

### 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Controller

```csharp
[HttpGet("search")]
public async Task<IActionResult> SearchUnits(
    [FromQuery] UnitSearchRequest request)
{
    var result = await _searchEngine.SearchUnitsAsync(request);
    
    return Ok(new
    {
        units = result.Units,
        total = result.TotalCount,
        page = result.PageNumber,
        pageSize = result.PageSize,
        totalPages = result.TotalPages,
        searchTimeMs = result.SearchTimeMs
    });
}
```

---

### 3. Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª

#### **Ø¨Ø­Ø« Ø¨Ø³ÙŠØ· - Ù…Ø¯ÙŠÙ†Ø© ÙÙ‚Ø·**
```json
GET /api/units/search?city=ØµÙ†Ø¹Ø§Ø¡

Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: ~10ms
Network Requests: 1
```

#### **Ø¨Ø­Ø« Ù…Ø¹ ØªÙˆØ§Ø±ÙŠØ®**
```json
GET /api/units/search?city=ØµÙ†Ø¹Ø§Ø¡&checkIn=2024-12-01&checkOut=2024-12-05

Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: ~50ms
Network Requests: 1 (Lua Script)
```

#### **Ø¨Ø­Ø« Ù…Ø¹Ù‚Ø¯ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±**
```json
POST /api/units/search
{
  "city": "ØµÙ†Ø¹Ø§Ø¡",
  "checkIn": "2024-12-01",
  "checkOut": "2024-12-05",
  "minPrice": 1000,
  "maxPrice": 5000,
  "guestsCount": 2,
  "requiredAmenities": ["pool", "wifi"],
  "sortBy": "price_asc",
  "pageNumber": 1,
  "pageSize": 20
}

Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: ~80ms
Network Requests: 1-2
```

---

## ğŸ”§ Ø§Ù„ØªÙƒÙˆÙŠÙ† ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª

### ÙÙŠ `appsettings.json`

```json
{
  "IndexingSettings": {
    "DefaultExpiryDays": 30,
    "IndexingLockTimeoutSeconds": 10,
    "BatchSize": 100,
    "MaxDegreeOfParallelism": 4,
    "MaxResultsBeforePagination": 1000
  },
  "Redis": {
    "ConnectionString": "localhost:6379",
    "DefaultDatabase": 0,
    "ConnectTimeout": 5000,
    "SyncTimeout": 3000
  }
}
```

---

## ğŸ“Š Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡ (Benchmarks)

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø¨Ø­Ø« ÙÙŠ 10,000 ÙˆØ­Ø¯Ø©
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±              â”‚ Ù‚Ø¨Ù„        â”‚ Ø¨Ø¹Ø¯          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ø¨Ø­Ø« Ø¨Ø³ÙŠØ·             â”‚ 50ms       â”‚ 10ms âœ…      â”‚
â”‚ Ø¨Ø­Ø« Ù…Ø¹ ØªÙˆØ§Ø±ÙŠØ®        â”‚ 200ms      â”‚ 50ms âœ…      â”‚
â”‚ Ø¨Ø­Ø« Ù…Ø¹Ù‚Ø¯             â”‚ 500ms      â”‚ 80ms âœ…      â”‚
â”‚ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø©      â”‚ 150MB      â”‚ 45MB âœ…      â”‚
â”‚ Network Requests     â”‚ 5-10       â”‚ 1-2 âœ…       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø­Ø³Ø§Ø¨ Ø£Ø³Ø¹Ø§Ø± 100 ÙˆØ­Ø¯Ø©
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±              â”‚ Ù‚Ø¨Ù„        â”‚ Ø¨Ø¹Ø¯          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ø§Ù„Ø²Ù…Ù† Ø§Ù„ÙƒÙ„ÙŠ          â”‚ 500ms      â”‚ 50ms âœ…      â”‚
â”‚ Ø¹Ø¯Ø¯ Queries          â”‚ 100        â”‚ 1 âœ…         â”‚
â”‚ Network Latency      â”‚ 400ms      â”‚ 10ms âœ…      â”‚
â”‚ Processing Time      â”‚ 100ms      â”‚ 40ms âœ…      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ø§Ù„ØªØ­Ø³ÙŠÙ†: 90% Ø£Ø³Ø±Ø¹ âš¡
```

---

## ğŸ¯ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª

### âœ… DO - Ø§ÙØ¹Ù„

1. **Ø§Ø³ØªØ®Ø¯Ù… Lua Scripts Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©**
   ```csharp
   // âœ… Ø¬ÙŠØ¯ - Ø¹Ù…Ù„ÙŠØ© ÙˆØ§Ø­Ø¯Ø©
   await SearchWithDatesAndPricesAsync(request);
   ```

2. **Ø§Ø³ØªØ®Ø¯Ù… Pipeline Ù„Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠØ©**
   ```csharp
   // âœ… Ø¬ÙŠØ¯ - Ø¬Ù„Ø¨ 100 Ø¹Ù†ØµØ± Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©
   var batch = db.CreateBatch();
   // ... add tasks
   batch.Execute();
   ```

3. **Ø­Ù…Ù‘Ù„ Lua Scripts Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡**
   ```csharp
   // âœ… Ø¬ÙŠØ¯ - ÙÙŠ Startup
   await searchEngine.PreloadScriptsAsync();
   ```

### âŒ DON'T - Ù„Ø§ ØªÙØ¹Ù„

1. **Ù„Ø§ ØªØ¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ù… ØªØ¹Ø§Ù„Ø¬Ù‡Ø§ ÙÙŠ C#**
   ```csharp
   // âŒ Ø³ÙŠØ¡ - Ø¬Ù„Ø¨ ÙƒÙ„ Ø´ÙŠØ¡
   var allUnits = await GetAllUnitsAsync();
   var filtered = allUnits.Where(u => criteria);
   ```

2. **Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… N+1 queries**
   ```csharp
   // âŒ Ø³ÙŠØ¡ - query Ù„ÙƒÙ„ ÙˆØ­Ø¯Ø©
   foreach (var unit in units)
   {
       var price = await CalculatePriceAsync(unit.Id);
   }
   ```

3. **Ù„Ø§ ØªÙ†Ø³Ù‰ ØªØ­Ù…ÙŠÙ„ Scripts**
   ```csharp
   // âŒ Ø³ÙŠØ¡ - Ø³ÙŠÙØ´Ù„
   await searchEngine.SearchUnitsAsync(request);
   // Ø¨Ø¯ÙˆÙ† PreloadScriptsAsync()
   ```

---

## ğŸ” Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡

### Logging

```csharp
_logger.LogInformation(
    "ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ø³Ù‘Ù†: City={City}, Duration={Ms}ms",
    request.City, stopwatch.ElapsedMilliseconds);
```

### Metrics

```csharp
// ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¯Ø§Ø¡
public class SearchMetrics
{
    public long SearchTimeMs { get; set; }
    public int ResultsCount { get; set; }
    public int NetworkRequests { get; set; }
    public string Strategy { get; set; } // "Lua" or "Direct"
}
```

---

## ğŸš¨ Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø®Ø·Ø£: "Script not loaded"
**Ø§Ù„Ø³Ø¨Ø¨:** Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ `PreloadScriptsAsync()`

**Ø§Ù„Ø­Ù„:**
```csharp
// ÙÙŠ Program.cs Ø¨Ø¹Ø¯ Build
await searchEngine.PreloadScriptsAsync();
```

---

### Ø®Ø·Ø£: "Slow performance"
**Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©:**
1. Redis ØºÙŠØ± Ù…Ø­Ø³Ù‘Ù†
2. Network Latency Ø¹Ø§Ù„ÙŠ
3. Ø¹Ø¯Ø¯ ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬

**Ø§Ù„Ø­Ù„ÙˆÙ„:**
```csharp
// 1. ØªØ­Ø¯ÙŠØ¯ PageSize Ù…Ø¹Ù‚ÙˆÙ„
request.PageSize = 20; // Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 1000

// 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Indexes Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
// ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ idx:units:v3

// 3. Ù…Ø±Ø§Ù‚Ø¨Ø© Redis
redis-cli INFO stats
```

---

## ğŸ“ˆ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©

### Ù‚ØµÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ù‰
- âœ… Lua Scripts (Ù…Ù†Ø¬Ø²)
- âœ… Pipeline (Ù…Ù†Ø¬Ø²)
- â³ Redis Cluster Support
- â³ Caching Layer

### Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ø¯Ù‰
- â³ Redis Modules (RedisGears)
- â³ ML-based relevance scoring
- â³ Auto-scaling based on load

### Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ù…Ø¯Ù‰
- â³ Distributed Search
- â³ Real-time indexing
- â³ Geo-distributed caching

---

## ğŸ“š Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹

- [Redis Lua Scripting](https://redis.io/docs/manual/programmability/eval-intro/)
- [RediSearch Documentation](https://redis.io/docs/stack/search/)
- [StackExchange.Redis Pipeline](https://stackexchange.github.io/StackExchange.Redis/PipelinesMultiplexers)

---

## ğŸ‘¨â€ğŸ’» Ø§Ù„Ù…Ø³Ø§Ù‡Ù…Ø©

Ù„Ù„Ù…Ø³Ø§Ù‡Ù…Ø© ÙÙŠ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡:
1. Ù‚Ù… Ø¨Ù‚ÙŠØ§Ø³ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯
2. Ø£Ø¶Ù tests Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØµØ­Ø©
3. ÙˆØ«Ù‘Ù‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª

---

## ğŸ“„ Ø§Ù„ØªØ±Ø®ÙŠØµ

Ø¬Ø²Ø¡ Ù…Ù† Ù…Ø´Ø±ÙˆØ¹ YemenBooking - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©

---

**âœ¨ ØªÙ… Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­ - Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„ÙØ§Ø¦Ù‚! âš¡**
