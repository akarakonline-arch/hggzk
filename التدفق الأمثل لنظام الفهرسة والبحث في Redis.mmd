%%{init: {'theme':'dark', 'themeVariables': { 'primaryColor':'#1e40af', 'primaryTextColor':'#fff', 'primaryBorderColor':'#3b82f6', 'lineColor':'#60a5fa', 'fontSize': '16px'}}}%%

%% ================================================================
%% Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ø£Ù…Ø«Ù„ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙ‡Ø±Ø³Ø© ÙˆØ§Ù„Ø¨Ø­Ø« ÙÙŠ Redis
%% ================================================================

flowchart TB
    %% ================== Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ù„ÙÙ‡Ø±Ø³Ø© ==================
    subgraph IndexingLayer["ğŸ—ï¸ Ø·Ø¨Ù‚Ø© Ø§Ù„ÙÙ‡Ø±Ø³Ø© Ø§Ù„Ø°ÙƒÙŠØ©"]
        subgraph DataStructure["ğŸ“Š Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Redis"]
            DS1["<b>ğŸ”‘ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</b><br/>property:{id} â†’ Hash<br/>property:{id}:bin â†’ MessagePack<br/>property:{id}:meta â†’ Metadata"]
            DS2["<b>ğŸ“ Ø§Ù„ÙÙ‡Ø§Ø±Ø³ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©</b><br/>geo:properties â†’ GEOADD<br/>geo:cities:{city} â†’ GEOADD"]
            DS3["<b>ğŸ“ˆ ÙÙ‡Ø§Ø±Ø³ Ø§Ù„ØªØ±ØªÙŠØ¨</b><br/>idx:price â†’ Sorted Set<br/>idx:rating â†’ Sorted Set<br/>idx:created â†’ Sorted Set"]
            DS4["<b>ğŸ·ï¸ ÙÙ‡Ø§Ø±Ø³ Ø§Ù„ØªØµÙ†ÙŠÙ</b><br/>tag:type:{typeId} â†’ Set<br/>tag:city:{city} â†’ Set<br/>tag:amenity:{id} â†’ Set"]
            DS5["<b>ğŸ“… ÙÙ‡Ø§Ø±Ø³ Ø§Ù„Ø¥ØªØ§Ø­Ø©</b><br/>avail:unit:{id} â†’ Sorted Set<br/>avail:date:{YYYYMMDD} â†’ Set"]
            DS6["<b>ğŸ” ÙÙ‡Ø±Ø³ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ</b><br/>FT.CREATE idx:properties<br/>ON HASH PREFIX property:"]
        end
        
        subgraph IndexingProcess["âš™ï¸ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ÙÙ‡Ø±Ø³Ø©"]
            IP1[["ğŸ“¥ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±"]] --> IP2{{"ğŸ”„ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ"}}
            IP2 -->|"Ø¥Ø¶Ø§ÙØ©"| IP3["ğŸ†• Ø¥Ù†Ø´Ø§Ø¡ ÙÙ‡Ø±Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø©"]
            IP2 -->|"ØªØ­Ø¯ÙŠØ«"| IP4["â™»ï¸ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙ‡Ø§Ø±Ø³"]
            IP2 -->|"Ø­Ø°Ù"| IP5["ğŸ—‘ï¸ Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„ÙÙ‡Ø§Ø±Ø³"]
            
            IP3 --> IP6["ğŸ“¦ Pipeline Transaction"]
            IP4 --> IP6
            IP5 --> IP6
            
            IP6 --> IP7["âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙÙ‡Ø±Ø³Ø©"]
        end
    end

    %% ================== Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ø³Ù† ==================
    subgraph OptimizedSearch["ğŸ” Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ø³Ù†"]
        Start([ğŸ¯ Ø·Ù„Ø¨ Ø§Ù„Ø¨Ø­Ø«]) --> CacheCheck{{"ğŸ’¾ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ÙƒØ§Ø´ØŸ"}}
        
        CacheCheck -->|"âœ… Ù†Ø¹Ù…"| ReturnCached["ğŸ“¤ Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ù† Ø§Ù„ÙƒØ§Ø´<br/><i>~5ms</i>"]
        CacheCheck -->|"âŒ Ù„Ø§"| AnalyzeRequest["ğŸ§  ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨"]
        
        AnalyzeRequest --> DetermineStrategy{{"ğŸ¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©"}}
        
        DetermineStrategy -->|"Ø¨Ø­Ø« Ù†ØµÙŠ"| TextSearchPath
        DetermineStrategy -->|"Ø¨Ø­Ø« Ø¬ØºØ±Ø§ÙÙŠ"| GeoSearchPath
        DetermineStrategy -->|"ÙÙ„ØªØ±Ø© Ù…Ø¹Ù‚Ø¯Ø©"| ComplexFilterPath
        DetermineStrategy -->|"Ø¨Ø­Ø« Ø¨Ø³ÙŠØ·"| SimpleSearchPath
        
        subgraph TextSearchPath["ğŸ“ Ù…Ø³Ø§Ø± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ"]
            TS1["FT.SEARCH Ù…Ø¹ RediSearch"] --> TS2["ØªØ·Ø¨ÙŠÙ‚ ÙÙ„Ø§ØªØ± Ø¥Ø¶Ø§ÙÙŠØ©"]
        end
        
        subgraph GeoSearchPath["ğŸŒ Ù…Ø³Ø§Ø± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ"]
            GS1["GEOSEARCH Ø¨Ø§Ù„Ù…ÙˆÙ‚Ø¹"] --> GS2["ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„Ù…Ø³Ø§ÙØ©"]
        end
        
        subgraph ComplexFilterPath["ğŸ”§ Ù…Ø³Ø§Ø± Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©"]
            CF1["Lua Script Ù…Ø­Ø³Ù†"] --> CF2["ÙÙ„ØªØ±Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±"]
        end
        
        subgraph SimpleSearchPath["âš¡ Ù…Ø³Ø§Ø± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¨Ø³ÙŠØ·"]
            SS1["SINTER Ù„Ù„ØªÙ‚Ø§Ø·Ø¹Ø§Øª"] --> SS2["ZRANGE Ù„Ù„ØªØ±ØªÙŠØ¨"]
        end
        
        TS2 --> MergeResults["ğŸ”€ Ø¯Ù…Ø¬ Ø§Ù„Ù†ØªØ§Ø¦Ø¬"]
        GS2 --> MergeResults
        CF2 --> MergeResults
        SS2 --> MergeResults
    end

    %% ================== Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥ØªØ§Ø­Ø© ==================
    subgraph AvailabilityLayer["ğŸ“… Ø·Ø¨Ù‚Ø© ÙØ­Øµ Ø§Ù„Ø¥ØªØ§Ø­Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©"]
        MergeResults --> CheckAvailability{{"ğŸ“… ÙØ­Øµ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ù…Ø·Ù„ÙˆØ¨ØŸ"}}
        
        CheckAvailability -->|"Ù†Ø¹Ù…"| AvailabilityPipeline
        CheckAvailability -->|"Ù„Ø§"| SkipAvailability["â­ï¸ ØªØ®Ø·ÙŠ ÙØ­Øµ Ø§Ù„Ø¥ØªØ§Ø­Ø©"]
        
        subgraph AvailabilityPipeline["ğŸ”„ Ø®Ø· Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥ØªØ§Ø­Ø©"]
            AP1["ğŸ“‹ Ø¬Ù„Ø¨ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©<br/>SINTER avail:date:{dates}"]
            AP1 --> AP2["ğŸ¢ ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ÙˆØ­Ø¯Ø©"]
            AP2 --> AP3["ğŸ‘¥ ÙØ­Øµ Ø§Ù„Ø³Ø¹Ø©"]
            AP3 --> AP4["ğŸ’° ÙØ­Øµ Ø§Ù„Ø³Ø¹Ø±"]
            AP4 --> AP5["âœ… Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ù…Ø¤ÙƒØ¯Ø©"]
        end
        
        AvailabilityPipeline --> EnrichData
        SkipAvailability --> EnrichData
    end

    %% ================== Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©: Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ==================
    subgraph EnrichmentLayer["ğŸ’ Ø·Ø¨Ù‚Ø© Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"]
        EnrichData["ğŸ”„ Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"] --> BatchFetch{{"ğŸ“¦ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¬Ù„Ø¨"}}
        
        BatchFetch --> UsePipeline["ğŸš€ Redis Pipeline"]
        
        subgraph UsePipeline["Pipeline Ù…Ø­Ø³Ù†"]
            PL1["MGET Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø©"]
            PL2["HMGET Ù„Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©"]
            PL3["SMEMBERS Ù„Ù„Ø¹Ù„Ø§Ù‚Ø§Øª"]
            PL4["ØªÙ†ÙÙŠØ° Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©"]
            
            PL1 --> PL4
            PL2 --> PL4
            PL3 --> PL4
        end
        
        PL4 --> ProcessBatch["âš™ï¸ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¯ÙØ¹Ø©"]
        ProcessBatch --> ApplyTransformation["ğŸ”„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª"]
    end

    %% ================== Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø®Ø§Ù…Ø³Ø©: Ø§Ù„ØªÙ‚Ø³ÙŠÙ… ÙˆØ§Ù„ØªØ±ØªÙŠØ¨ ==================
    subgraph PaginationLayer["ğŸ“„ Ø·Ø¨Ù‚Ø© Ø§Ù„ØªÙ‚Ø³ÙŠÙ… ÙˆØ§Ù„ØªØ±ØªÙŠØ¨"]
        ApplyTransformation --> SortStrategy{{"ğŸ“Š Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ±ØªÙŠØ¨"}}
        
        SortStrategy -->|"Ø§Ù„Ø³Ø¹Ø±"| SortByPrice["ğŸ’° ØªØ±ØªÙŠØ¨ Ø¨Ø§Ù„Ø³Ø¹Ø±<br/>Ù…Ù† idx:price"]
        SortStrategy -->|"Ø§Ù„ØªÙ‚ÙŠÙŠÙ…"| SortByRating["â­ ØªØ±ØªÙŠØ¨ Ø¨Ø§Ù„ØªÙ‚ÙŠÙŠÙ…<br/>Ù…Ù† idx:rating"]
        SortStrategy -->|"Ø§Ù„Ø­Ø¯Ø§Ø«Ø©"| SortByDate["ğŸ“… ØªØ±ØªÙŠØ¨ Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ®<br/>Ù…Ù† idx:created"]
        SortStrategy -->|"Ø§Ù„Ù…Ø³Ø§ÙØ©"| SortByDistance["ğŸ“ ØªØ±ØªÙŠØ¨ Ø¨Ø§Ù„Ù…Ø³Ø§ÙØ©<br/>GEODIST"]
        
        SortByPrice --> ApplyPagination
        SortByRating --> ApplyPagination
        SortByDate --> ApplyPagination
        SortByDistance --> ApplyPagination
        
        ApplyPagination["ğŸ“„ ØªØ·Ø¨ÙŠÙ‚ Pagination<br/>LIMIT offset, count"]
        ApplyPagination --> PrepareResponse
    end

    %% ================== Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø³Ø§Ø¯Ø³Ø©: Ø§Ù„ÙƒØ§Ø´ ÙˆØ§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© ==================
    subgraph ResponseLayer["ğŸ“¤ Ø·Ø¨Ù‚Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©"]
        PrepareResponse["ğŸ“¦ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©"] --> CacheResult["ğŸ’¾ Ø­ÙØ¸ ÙÙŠ Ø§Ù„ÙƒØ§Ø´"]
        
        subgraph MultiLevelCache["ğŸ—ï¸ ÙƒØ§Ø´ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª"]
            L1Cache["L1: Memory Cache<br/>TTL: 30s"]
            L2Cache["L2: Redis Result Cache<br/>TTL: 2min"]
            L3Cache["L3: Redis Data Cache<br/>TTL: 10min"]
        end
        
        CacheResult --> StoreInCache["ğŸ’¾ ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù†ØªÙŠØ¬Ø©"]
        StoreInCache --> ReturnResponse([âœ… Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù†ØªÙŠØ¬Ø©])
    end

    %% ================== Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ==================
    subgraph MonitoringSystem["ğŸ“Š Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©"]
        MS1["â±ï¸ Ù‚ÙŠØ§Ø³ Ø§Ù„Ø£Ø¯Ø§Ø¡<br/>Response Time"]
        MS2["ğŸ“ˆ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­<br/>Hit Rate"]
        MS3["ğŸ’¾ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°Ø§ÙƒØ±Ø©<br/>Memory Usage"]
        MS4["ğŸ”„ Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙƒØ§Ø´<br/>Cache Hit Ratio"]
        MS5["âš ï¸ ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡<br/>Error Tracking"]
    end

    %% ================== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø­Ø³Ù†Ø© ==================
    subgraph ErrorHandling["ğŸ›¡ï¸ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø°ÙƒÙŠØ©"]
        EH1["ğŸ” Retry Policy<br/>3 Ù…Ø­Ø§ÙˆÙ„Ø§Øª"]
        EH2["âš¡ Circuit Breaker<br/>Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„ÙØ´Ù„"]
        EH3["ğŸ”„ Fallback Strategy<br/>Ø®Ø·Ø© Ø¨Ø¯ÙŠÙ„Ø©"]
        EH4["ğŸ“ Logging<br/>ØªØ³Ø¬ÙŠÙ„ Ù…ÙØµÙ„"]
        EH5["ğŸ“Š Metrics<br/>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø®Ø·Ø§Ø¡"]
    end

    %% ================== Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ==================
    subgraph CoreOptimizations["âš¡ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©"]
        subgraph LuaOptimization["ğŸ“œ Lua Scripts Ù…Ø­Ø³Ù†Ø©"]
            LO1["ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©"]
            LO2["Ø§Ø³ØªØ®Ø¯Ø§Ù… EVALSHA"]
            LO3["ØªÙ‚Ù„ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ§Øª I/O"]
            LO4["Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¯ÙØ¹ÙŠØ©"]
        end
        
        subgraph DataOptimization["ğŸ’¾ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"]
            DO1["Ø¶ØºØ· MessagePack"]
            DO2["ÙÙ‡Ø±Ø³Ø© Ø§Ù†ØªÙ‚Ø§Ø¦ÙŠØ©"]
            DO3["ØªÙ†Ø¸ÙŠÙ Ø¯ÙˆØ±ÙŠ"]
            DO4["Lazy Loading"]
        end
        
        subgraph QueryOptimization["ğŸ” ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª"]
            QO1["Query Planning"]
            QO2["Index Hints"]
            QO3["Parallel Execution"]
            QO4["Result Streaming"]
        end
    end

    %% ================== Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª ==================
    subgraph BestPractices["âœ… Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©"]
        BP1["ğŸ”’ Connection Pooling<br/>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª"]
        BP2["ğŸ“¦ Batch Operations<br/>Ø¹Ù…Ù„ÙŠØ§Øª Ø¯ÙØ¹ÙŠØ©"]
        BP3["â±ï¸ Timeout Management<br/>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ù„Ø§Øª"]
        BP4["ğŸ”„ Async/Await<br/>Ù…Ø¹Ø§Ù„Ø¬Ø© ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø©"]
        BP5["ğŸ’¾ Memory Management<br/>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©"]
        BP6["ğŸ” Security<br/>ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"]
    end

    %% ================== Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„ØªØ¯ÙÙ‚ ==================
    ReturnCached --> Success([ğŸ‰ Ø§Ù„Ù†Ø¬Ø§Ø­])
    ReturnResponse --> Success
    
    %% Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    Start -.->|"Ø®Ø·Ø£"| EH1
    EH1 --> EH2
    EH2 --> EH3
    EH3 -.->|"ÙØ´Ù„ Ù†Ù‡Ø§Ø¦ÙŠ"| Failure([âŒ ÙØ´Ù„])

    %% ================== Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ ==================
    subgraph PerformanceMetrics["ğŸ“Š Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©"]
        PM1["âš¡ Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©<br/>&lt; 100ms Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ø¨Ø³ÙŠØ·<br/>&lt; 300ms Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¹Ù‚Ø¯"]
        PM2["ğŸ’¾ Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙƒØ§Ø´<br/>&gt; 80% Hit Rate"]
        PM3["ğŸ”„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©<br/>&gt; 1000 req/sec"]
        PM4["ğŸ“ˆ Ø§Ù„ØªÙˆÙØ±<br/>&gt; 99.9% Uptime"]
    end

%% ================== Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† ==================
classDef primary fill:#1e40af,stroke:#3b82f6,stroke-width:3px,color:#fff,font-weight:bold
classDef secondary fill:#7c3aed,stroke:#8b5cf6,stroke-width:2px,color:#fff
classDef success fill:#059669,stroke:#10b981,stroke-width:2px,color:#fff
classDef warning fill:#d97706,stroke:#f59e0b,stroke-width:2px,color:#fff
classDef error fill:#dc2626,stroke:#ef4444,stroke-width:2px,color:#fff
classDef info fill:#0891b2,stroke:#06b6d4,stroke-width:2px,color:#fff

class Start,CacheCheck,DetermineStrategy primary
class AnalyzeRequest,MergeResults,EnrichData secondary
class ReturnResponse,Success success
class EH1,EH2,EH3,EH4,EH5 warning
class Failure error
class MS1,MS2,MS3,MS4,MS5 info